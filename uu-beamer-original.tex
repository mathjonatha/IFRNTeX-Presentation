\ProvidesClass{uu-beamer}[Uppsala University Presentation Template v1.0]
\NeedsTeXFormat{LaTeX2e}

% Parent class
\DeclareOption*{\PassOptionsToClass{\CurrentOption}{beamer}}
\ProcessOptions \relax
\LoadClass{beamer}

% Set subtitles black
\usecolortheme[named=black]{structure}

%Font sizes
\setbeamerfont*{title}{size=\LARGE}
\setbeamerfont*{subtitle}{size=\normalsize}
\setbeamerfont{normal text}{size=\footnotesize}
\AtBeginDocument{\usebeamerfont{normal text}}

% Remove default logo
\logo{}

% Remove navigation bar
\beamertemplatenavigationsymbolsempty

% Background
\usepackage{tikz}

\usebackgroundtemplate{
    \begin{tikzpicture}[overlay,remember picture]
        % Background picture
        \node[at=(current page.south east),anchor=south east,inner sep=0pt,outer sep=0pt] {
            \includegraphics[keepaspectratio,height=0.8\paperheight]{uu_logo_bg}};

        % Top border
        \draw [line width=2mm,color=bgcolor] (current page.north west) rectangle (current page.north east);

        % Bottom border
        \draw [line width=2mm,color=bgcolor] (current page.south west) rectangle (current page.south east);

        % Logo
        \node[at=(current page.north west),anchor=north west,inner sep=0pt,outer sep=10pt] {
            \includegraphics[keepaspectratio,height=1.5cm]{urban_lab_logo_text}};


    \end{tikzpicture}
}


% Letter spacing
\usepackage[letterspace=90]{microtype}

% Element margins
\setbeamerfont*{frametitle}{size=\Large} 
\setbeamertemplate{frametitle}[default][left,leftskip=35mm] % horizontal margin left
\addtobeamertemplate{frametitle}{\vskip+1cm \lsstyle}{} % vertical magin + letter spacing

\setbeamersize{text margin left=2cm}
\setbeamersize{text margin right=2cm}

% Uppercase titles
\newcommand{\Frametitle}[1]{\frametitle{\large \MakeUppercase{#1}}}

% Bullet lists
\setbeamertemplate{itemize items}[circle]

% Fonts 
\usepackage{mathptmx}
\usepackage{helvet}
%\usefonttheme{serif} % Uncomment to use Times-like font


%%%%%%%%%%%%%%%%%%%% Standard frames %%%%%%%%%%%%%%%%%%%

%______ Title page ______%
\defbeamertemplate*{title page}{customized}[1][]
{
    \begin{frame}
        \clearpage
        \vspace*{\fill}
        \begin{center}
            \usebeamerfont*{title} \textls[90]{\MakeUppercase{\inserttitle}}\par
            \vspace{15pt}
            \usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\textls[150]{\small \MakeUppercase{\insertsubtitle}}\par
        \end{center}
        \vfill
        \clearpage
    \end{frame}
}

%______ Logo page ______%
\definecolor{bgcolor}{RGB}{48,92,40}

\newcommand{\logopage}{
    {
        \usetikzlibrary{backgrounds}
        \usebackgroundtemplate{
            \tikz[overlay,remember picture,background rectangle/.style={fill=bgcolor}, show background rectangle]
            \node[at=(current page.north west),anchor=north west,inner sep=0pt, inner xsep=1cm] {
              \includegraphics[keepaspectratio,width=2cm]{uu_logo_red}};
          }

        \begin{frame}[plain]
            \begin{center}
                \includegraphics[height=0.6\paperheight]{style/graphics/urban_lab_logo} \par
                \color{white} \Large \textls[30]{\textbf{Urban Lab}}
            \end{center}
            \vfill
        \end{frame}
    }
}

%%%%%%%%%%%%%%%%%%%% Custom frames %%%%%%%%%%%%%%%%%%%

%______ Subtitle page ______%
\newcommand{\anothertitle}[2]
{
    \begin{frame}
        \clearpage
        \vspace*{\fill}
        \begin{center}
                \usebeamerfont*{title}{\textls[90]{\MakeUppercase{#1}}}\par
                \vspace{15pt}
                \usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\textls[150]{\small \MakeUppercase{#2}}\par
        \end{center}
        \vfill
        \clearpage
        \end{frame}
}

%______ Title + graphics + subtitle page ______%
\newcommand{\titleimage}[3]
{
    {
        \setbeamertemplate{frametitle}[default][center]
        \addtobeamertemplate{frametitle}{\vskip+1cm}{}

        \begin{frame}
            \frametitle[center]{\LARGE {\textls[90]{\MakeUppercase{#1}}}}

            \begin{center}
                \includegraphics<1>[height=4.5cm]{{#3}} \par
                \vspace{0.5cm}
                \scriptsize
                \textls[150]{\MakeUppercase{#2}}
            \end{center}
            
        \end{frame}
    }
}


%______ Fullsize image page ______%
\newcommand{\fullimage}[1]
{
    {
        \usebackgroundtemplate{
            \begin{tikzpicture}[overlay,remember picture]

                % Background picture
                \node[at=(current page.south east),anchor=south east,inner sep=0pt,outer sep=0pt] {
                    \includegraphics[keepaspectratio,height=0.8\paperheight]{uu_logo_bg}};

                % Image
                \node[at=(current page.center),anchor=center,inner sep=0pt,outer sep=0pt] {
                    \includegraphics[keepaspectratio,width=\paperwidth,height=\paperheight]{{#1}}};

                % Top border
                \draw [line width=2mm,color=bgcolor] (current page.north west) rectangle (current page.north east);

                % Bottom border
                \draw [line width=2mm,color=bgcolor] (current page.south west) rectangle (current page.south east);

            \end{tikzpicture}
        }
        \begin{frame}[plain]
        \end{frame}
    }
}